"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[1184],{1172(n,t,e){e.r(t),e.d(t,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"module-3-digital-twin/chapter-4-unity-integration/solutions","title":"Unity Visualization and Interaction - Solutions","description":"Solution 4.1: Unity Environment Setup for Robotics","source":"@site/docs/module-3-digital-twin/chapter-4-unity-integration/solutions.md","sourceDirName":"module-3-digital-twin/chapter-4-unity-integration","slug":"/module-3-digital-twin/chapter-4-unity-integration/solutions","permalink":"/Physicial_Ai_Book_Hackathon_1/docs/module-3-digital-twin/chapter-4-unity-integration/solutions","draft":false,"unlisted":false,"editUrl":"https://github.com/shirazkk/Physicial_Ai_Book_Hackathon_1/edit/main/my-website/docs/module-3-digital-twin/chapter-4-unity-integration/solutions.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Unity Visualization and Interaction - Exercises","permalink":"/Physicial_Ai_Book_Hackathon_1/docs/module-3-digital-twin/chapter-4-unity-integration/exercises"}}');var i=e(4848),s=e(8453);const r={},l="Unity Visualization and Interaction - Solutions",a={},c=[{value:"Solution 4.1: Unity Environment Setup for Robotics",id:"solution-41-unity-environment-setup-for-robotics",level:2},{value:"Solution 4.2: Robot Model Integration",id:"solution-42-robot-model-integration",level:2},{value:"Solution 4.3: ROS-Unity Communication Implementation",id:"solution-43-ros-unity-communication-implementation",level:2}];function d(n){const t={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"unity-visualization-and-interaction---solutions",children:"Unity Visualization and Interaction - Solutions"})}),"\n",(0,i.jsx)(t.h2,{id:"solution-41-unity-environment-setup-for-robotics",children:"Solution 4.1: Unity Environment Setup for Robotics"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Setting up Unity project with robotics packages:"})}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Unity Installation:"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Download Unity Hub from unity.com"}),"\n",(0,i.jsx)(t.li,{children:"Install Unity 2021.3 LTS or newer"}),"\n",(0,i.jsx)(t.li,{children:"Create a new 3D project"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Installing ROS-TCP-Connector:"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"# In Unity Package Manager\n# Window > Package Manager > Add package from git URL\n# https://github.com/Unity-Technologies/ROS-TCP-Connector.git\n"})}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Basic robot visualization scene:"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-csharp",children:'using UnityEngine;\nusing Unity.Robotics.ROSTCPConnector;\n\npublic class RobotVisualization : MonoBehaviour\n{\n    public GameObject robotModel;\n    private ROSConnection ros;\n\n    void Start()\n    {\n        ros = ROSConnection.GetOrCreateInstance();\n        ros.Initialize("127.0.0.1", 10000);\n\n        // Subscribe to robot state messages\n        ros.Subscribe<JointState>("/joint_states", OnJointStateReceived);\n    }\n\n    void OnJointStateReceived(JointState jointState)\n    {\n        // Update robot model based on joint positions\n        UpdateRobotModel(jointState);\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Test connection:"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-csharp",children:'// Publisher example\nvoid SendTestMessage()\n{\n    var testMsg = new StringMessage("Hello ROS from Unity!");\n    ros.Send("test_topic", testMsg);\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"solution-42-robot-model-integration",children:"Solution 4.2: Robot Model Integration"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Importing and setting up robot model:"})}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"CAD Model Preparation:"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"# Convert URDF to COLLADA (DAE) format\nurdf_to_collada robot.urdf robot.dae\n\n# Or export directly from CAD software as FBX\n"})}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Unity Import Settings:"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-csharp",children:'// Robot hierarchy setup\npublic class RobotModelSetup : MonoBehaviour\n{\n    [Header("Robot Links")]\n    public Transform baseLink;\n    public Transform torso;\n    public Transform leftArm;\n    public Transform rightArm;\n    public Transform head;\n\n    [Header("Joint Parameters")]\n    public float[] jointLimitsMin;\n    public float[] jointLimitsMax;\n\n    void Start()\n    {\n        SetupRobotHierarchy();\n        InitializeJointControllers();\n    }\n\n    void SetupRobotHierarchy()\n    {\n        // Ensure proper parent-child relationships\n        torso.SetParent(baseLink);\n        leftArm.SetParent(torso);\n        rightArm.SetParent(torso);\n        head.SetParent(torso);\n    }\n\n    void InitializeJointControllers()\n    {\n        // Set up joint constraints and limits\n        foreach(Transform joint in GetComponentsInChildren<Transform>())\n        {\n            var jointComponent = joint.GetComponent<ConfigurableJoint>();\n            if (jointComponent != null)\n            {\n                ConfigureJointLimits(jointComponent);\n            }\n        }\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Scale and Units:"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-csharp",children:"// Ensure proper scaling (meters for robotics)\npublic class RobotScaler : MonoBehaviour\n{\n    public float scaleFactor = 1.0f; // Unity units = meters\n\n    void Start()\n    {\n        transform.localScale = Vector3.one * scaleFactor;\n    }\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"solution-43-ros-unity-communication-implementation",children:"Solution 4.3: ROS-Unity Communication Implementation"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Bidirectional ROS-Unity communication:"})}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"ROS Node Setup:"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport rospy\nfrom sensor_msgs.msg import JointState\nfrom geometry_msgs.msg import Twist\n\nclass RobotController:\n    def __init__(self):\n        rospy.init_node('unity_robot_controller')\n\n        # Publishers\n        self.joint_pub = rospy.Publisher('/joint_states', JointState, queue_size=10)\n        self.cmd_vel_pub = rospy.Publisher('/cmd_vel', Twist, queue_size=10)\n\n        # Subscribers\n        rospy.Subscriber('/unity_cmd_vel', Twist, self.velocity_callback)\n\n        self.rate = rospy.Rate(50)  # 50 Hz\n        self.joint_positions = [0.0] * 6  # Example 6DOF robot\n\n    def velocity_callback(self, msg):\n        # Process velocity commands from Unity\n        linear_vel = msg.linear.x\n        angular_vel = msg.angular.z\n        print(f\"Received velocity command: {linear_vel}, {angular_vel}\")\n\n    def publish_joint_states(self):\n        msg = JointState()\n        msg.name = ['joint1', 'joint2', 'joint3', 'joint4', 'joint5', 'joint6']\n        msg.position = self.joint_positions\n        msg.header.stamp = rospy.Time.now()\n        self.joint_pub.publish(msg)\n\n    def run(self):\n        while not rospy.is_shutdown():\n            self.publish_joint_states()\n            self.rate.sleep()\n\nif __name__ == '__main__':\n    controller = RobotController()\n    controller.run()\n"})}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Unity ROS Connection:"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-csharp",children:'using UnityEngine;\nusing Unity.Robotics.ROSTCPConnector;\nusing Unity.Robotics.ROSTCPConnector.MessageTypes.Sensor;\n\npublic class ROSUnityBridge : MonoBehaviour\n{\n    ROSConnection ros;\n    public RobotModel robotModel;\n\n    void Start()\n    {\n        ros = ROSConnection.GetOrCreateInstance();\n        ros.Initialize("127.0.0.1", 10000);\n\n        // Subscribe to joint states\n        ros.Subscribe<JointState>("/joint_states", OnJointStateReceived);\n    }\n\n    void OnJointStateReceived(JointState jointState)\n    {\n        // Update Unity robot model\n        for (int i = 0; i < jointState.name.Count; i++)\n        {\n            robotModel.SetJointPosition(jointState.name[i], jointState.position[i]);\n        }\n    }\n\n    public void SendVelocityCommand(float linear, float angular)\n    {\n        var twist = new Twist();\n        twist.linear = new Vector3(linear, 0, 0);\n        twist.angular = new Vector3(0, 0, angular);\n\n        ros.Send("/unity_cmd_vel", twist);\n    }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Connection Error Handling:"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-csharp",children:'public class RobustROSConnection : MonoBehaviour\n{\n    ROSConnection ros;\n    private bool isConnected = false;\n    private float reconnectTimer = 0f;\n    private const float RECONNECT_INTERVAL = 5f;\n\n    void Start()\n    {\n        ConnectToROS();\n    }\n\n    void ConnectToROS()\n    {\n        try\n        {\n            ros = ROSConnection.GetOrCreateInstance();\n            ros.Initialize("127.0.0.1", 10000);\n            isConnected = true;\n        }\n        catch (System.Exception ex)\n        {\n            Debug.LogError($"Failed to connect to ROS: {ex.Message}");\n            isConnected = false;\n        }\n    }\n\n    void Update()\n    {\n        if (!isConnected)\n        {\n            reconnectTimer += Time.deltaTime;\n            if (reconnectTimer >= RECONNECT_INTERVAL)\n            {\n                ConnectToROS();\n                reconnectTimer = 0f;\n            }\n        }\n    }\n}\n'})}),"\n"]}),"\n"]})]})}function u(n={}){const{wrapper:t}={...(0,s.R)(),...n.components};return t?(0,i.jsx)(t,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}},8453(n,t,e){e.d(t,{R:()=>r,x:()=>l});var o=e(6540);const i={},s=o.createContext(i);function r(n){const t=o.useContext(s);return o.useMemo(function(){return"function"==typeof n?n(t):{...t,...n}},[t,n])}function l(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:r(n.components),o.createElement(s.Provider,{value:t},n.children)}}}]);